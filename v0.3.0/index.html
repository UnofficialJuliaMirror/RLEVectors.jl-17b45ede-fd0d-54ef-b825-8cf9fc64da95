<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Run Length Encoded vectors for julia, inspired by BioConductor.">
  <meta name="author" content="Peter Haverty">
  
  <title>RLEVectors.jl</title>
  

  <link rel="shortcut icon" href="./img/favicon.ico">

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="./css/theme.css" type="text/css" />
  <link rel="stylesheet" href="./css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="./css/highlight.css">
  <link href="./assets/Documenter.css" rel="stylesheet">

  
  <script>
    // Current page data
    var mkdocs_page_name = "None";
    var mkdocs_page_input_path = "index.md";
    var mkdocs_page_url = "/";
  </script>
  
  <script src="./js/jquery-2.1.1.min.js"></script>
  <script src="./js/modernizr-2.8.3.min.js"></script>
  <script type="text/javascript" src="./js/highlight.pack.js"></script>
  <script src="./js/theme.js"></script> 
  <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  <script src="./assets/mathjaxhelper.js"></script>

  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="." class="icon icon-home"> RLEVectors.jl</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="./search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        <ul class="current">
          
            <li>
    <li class="toctree-l1 current">
        <a class="current" href=".">Home</a>
        
            <ul>
            
                <li class="toctree-l3"><a href="#rlevectors">RLEVectors</a></li>
                
                    <li><a class="toctree-l4" href="#background">Background</a></li>
                
                    <li><a class="toctree-l4" href="#implementation-details">Implementation Details</a></li>
                
                    <li><a class="toctree-l4" href="#split-and-tapply-like-operations">split and tapply -like operations</a></li>
                
                    <li><a class="toctree-l4" href="#relative-speed">Relative speed</a></li>
                
                    <li><a class="toctree-l4" href="#memory-considerations">Memory considerations</a></li>
                
            
            </ul>
        
    </li>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>News</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="NEWS/">Changelog</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="TODO/">TODO</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="api/">API</a>
        
    </li>
<li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href=".">RLEVectors.jl</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".">Docs</a> &raquo;</li>
    
      
    
    <li>Home</li>
    <li class="wy-breadcrumbs-aside">
      
        
          <a href="https://github.com/phaverty/RLEVectors.jl" class="icon icon-github"> Edit on GitHub</a>
        
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <p><a id='RLEVectors-1'></a></p>
<h1 id="rlevectors">RLEVectors</h1>
<p><code>RLEVectors</code> is an alternate implementation of the Rle type from Bioconductor's IRanges package by H. Pages, P. Aboyoun and M. Lawrence. RLEVectors represent a vector with repeated values as the ordered set of values and repeat extents. In the field of genomics, data of various types are  measured across the ~3 billion letters in the human genome can often be represented in a few thousand runs. It is useful to know the bounds of genome regions covered by these runs, the values associated with these runs, and to be able to perform various mathematical operations on these values.</p>
<p><a id='Background-1'></a></p>
<h2 id="background">Background</h2>
<p>Bioconductor has some widely used and extremely convenient types for working with collections of ranges, which sometimes are with associated data.<code>IRanges</code> represents a collection of arbitrary start, end pairs in [1,Inf). <code>GRanges</code> uses <code>IRanges</code> to represent locations on a genome and adds annotation of the chromosome and strand for each range. Children of <code>GRanges</code> add other annotations the the ranges. <code>Rle</code> represents the range [1:n] broken into arbitrary chunks or segments.</p>
<p><a id='Implementation-Details-1'></a></p>
<h2 id="implementation-details">Implementation Details</h2>
<p><code>RLEVectors</code> differs from R's <code>Rle</code> in that we store the run values and run ends rather than the run values and run lengths. The run ends are convenient in that they allow for indexing into the vector by binary search (scalar indexing is O(log(n)) rather than O(n) ). Additionally, <code>length</code> is O(1) rather than O(n) (it's the last run end rather than the sum of the run lengths). On the other hand, various operations do require the run lengths, which have to be calculated. See the benchmark directory and reports to see how this plays out.</p>
<p><a id='Creation-1'></a></p>
<h3 id="creation">Creation</h3>
<p><code>RLEVectors</code> can be created from a single vector or a vector of values and a vector of run ends. In either case runs of values or zero length runs will be compressed out. RLEVectors can be expanded to a full vector like a <code>Range</code> with <code>collect</code>.</p>
<pre><code class="julia">using RLEVectors
x = RLEVector([1,1,2,2,3,3,4,4,4])
collect(x)
y = RLEVector([4,5,6],[3,6,9])
collect(y)
</code></pre>

<p><a id='Describing-1'></a></p>
<h3 id="describing">Describing</h3>
<p><code>RLEVector</code>s implement the usual descriptive functions for an array as well as some that are specific to the type.</p>
<ul>
<li><code>length(x)</code> The full length of the vector, uncompressed</li>
<li><code>size(x)</code> Same as <code>length</code>, as for any other vector</li>
<li><code>size(x,dim)</code> Returns <code>(length(x),1) for dim == 1</code></li>
<li><code>rfirst(x)</code> The index of the beginning of each run</li>
<li><code>rwidth(x)</code> The width of each run</li>
<li><code>rlast(x)</code> The index of the end of each run</li>
<li><code>rvalue(x)</code> The data value for each run</li>
<li><code>isempty(x)</code> Returns boolean, as for any other vector</li>
<li><code>nrun(x)</code> Returns the number of runs represented in the array</li>
<li><code>eltype(x)</code> Returns the element type of the runs</li>
<li><code>endtype(x)</code> Returns the element type of the run ends</li>
</ul>
<p>Naming for some of these functions is difficult given that many useful names are already reserved words (<code>end</code>, <code>start</code>, <code>last</code>). Suggestions are welcome at this stage of development.</p>
<p><a id='Standard-vector-operations-1'></a></p>
<h3 id="standard-vector-operations">Standard vector operations</h3>
<p><code>RLEVector</code>s can be treated as standard Vectors for arithmetic and collection operations. In many cases these operations are more efficient than operations on a standard vector.</p>
<ul>
<li><code>x = RLEVector([4,5,6],[3,6,9])</code></li>
<li><code>x[2]</code></li>
<li><code>x[7:9] = 10</code></li>
<li><code>push!(x,6)</code></li>
<li><code>x + 2x</code></li>
<li><code>unique(x)</code></li>
<li><code>findin(x,5)</code></li>
<li><code>x &gt; 4.2</code></li>
<li><code>sort(x)</code></li>
<li><code>median(x)</code></li>
</ul>
<p><a id='split-and-tapply-like-operations-1'></a></p>
<h2 id="split-and-tapply-like-operations">split and tapply -like operations</h2>
<p>An RLEVector can be used like R's factor type to apply a function over (contiguous) sections of another vector. For example, here we break a vector into 5 groups and take the average of each group. In the second example, we also scale each mean by the RLE run value corresponding to each group.</p>
<pre><code class="julia">factor = repeat( [&quot;a&quot;,&quot;b&quot;,&quot;c&quot;,&quot;d&quot;,&quot;e&quot;], inner=20 )
rle = RLEVector( factor )
x = collect(1:100)
group_means = Float64[ mean(x[r]) for (v,r) in each(rle) ]
</code></pre>

<p>This is much like the <code>tapply</code> operation in R. A convenience wrapper with this name is provided. The second, factor, argument can be an <code>RLEVector</code> or a <code>Vector</code> to be converted to an <code>RLEVector</code>. This vector need not be sorted.</p>
<pre><code class="julia">tapply( x, factor, mean )
tapply( x, rle, mean )
</code></pre>

<p>In addition to the <code>Range</code> for each RLE run, the <code>each</code> iterator provides the corresponding run value. These values can be used in calculations on each vector block.</p>
<pre><code class="julia">x = collect(1:100)
rle2 = RLEVector( repeat( [1,2,3,4,5], inner=20 ) )
scaled_group_means = Float64[ v * mean(x[r]) for (v,r) in each(rle2) ]
</code></pre>

<p><a id='Relative-speed-1'></a></p>
<h2 id="relative-speed">Relative speed</h2>
<p><code>RLEVectors</code> has been extensively profiled and somewhat optimized. Please see the benchmarking section for the evolution over time and comparisons to like operations in R.</p>
<p><a id='Benchmarks-1'></a></p>
<h3 id="benchmarks">Benchmarks</h3>
<p><strong> Please note that these benchmarks include data structure / algorithmic differences as well as language differences </strong> For example, indexing is O( log(n) ) in RLEVectors.jl and O(n) in the original R implementation. Similarly, <code>last</code> is a simple lookup in RLEVectors.jl where <code>width</code> is a lookup in the R version. Other functions listed here of the same computational order, but not necessarily direct translations. RLEVectors.jl is written in my interpretation of idiomatic julia.</p>
<p><img alt="Benchmarking results" src="./benchmark_rle_vectors.png" /></p>
<p><a id='Optimization-progress-1'></a></p>
<h3 id="optimization-progress">Optimization progress</h3>
<p><img alt="Optimization progress" src="./benchmark_rle_vectors.timeline.png" /></p>
<p><a id='Memory-considerations-1'></a></p>
<h2 id="memory-considerations">Memory considerations</h2>
<p>Data compression is a secondary benefit of <code>RLEVector</code>s, but it can be convenient. Generally run ends are stored as Int64. However, if further memory savings are desired, consider smaller and unsigned types. UInt32 is sufficient to hold the length of the human genome and UInt16 can hold the length of the longest human chromosome.</p>
<p><code>RLEVector([5.1,2.9,100.7], UInt16[4,8,22])</code></p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="NEWS/" class="btn btn-neutral float-right" title="Changelog">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
	  
        </div>
      </div>

    </section>

  </div>

<div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a href="https://github.com/phaverty/RLEVectors.jl" class="icon icon-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
      
        <span style="margin-left: 15px"><a href="NEWS/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>

</body>
</html>

<!--
MkDocs version : 0.15.3
Build Date UTC : 2016-10-27 05:02:39.599189
-->
